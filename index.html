<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î - ‡πÄ‡∏•‡πà‡∏ô‡∏•‡∏≠‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà</title>

<link rel="icon" href="logo.png">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Sans+Thai:wght@300;400;500;700&display=swap" rel="stylesheet">

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6972769827165057" crossorigin="anonymous"></script>

<style>
:root{
--primary:#f28482;--secondary:#84a59d;--accent:#457b9d;
--bg:#f7f8fa;--card:#fff;--success:#c7e7d3;--fail:#f8d7da;
--thai-gold: #C5A059; --thai-red: #8B2323; --thai-cream: #FDFBF7;
}
body{margin:0;font-family:'Noto Sans KR','Noto Sans Thai',sans-serif;background:var(--bg)}

.top-nav{position:sticky;top:0;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.08);z-index:1000}
.nav-inner{max-width:900px;margin:auto;padding:0 12px;display:flex;align-items:center;justify-content:space-between;height:56px}
.logo img{height:45px;display:block;cursor:pointer}
.menu{display:flex;gap:12px;font-weight:600;font-size:13px;white-space:nowrap}
.menu span{cursor:pointer}
.menu span:hover{color:var(--primary)}

.dropdown{position:relative}
.dropdown-menu{display:none;position:absolute;top:24px;right:0;background:#fff;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,.12);min-width:100px}
.dropdown-menu div{padding:10px 16px;cursor:pointer;font-size:13px}
.dropdown:hover .dropdown-menu{display:block}

main{max-width:600px;margin:auto;padding:20px}
.page{display:none}
.card{background:var(--card);padding:24px;border-radius:18px;box-shadow:0 6px 20px rgba(0,0,0,.08)}
h2,h3{color:var(--primary);margin-top:0}
.date{text-align:center;color:#777;margin-bottom:15px}
.input-box{display:flex;gap:10px;margin-bottom:15px}
input{flex:1;padding:12px;font-size:16px;border-radius:10px;border:1px solid #ddd}
button{padding:12px;border:none;border-radius:10px;background:var(--secondary);color:#fff;font-weight:bold;cursor:pointer}
.result{margin-top:15px;padding:15px;border-radius:12px;display:none}

.item{display:flex;flex-direction:column;padding:12px 0;border-bottom:1px dashed #eee}
.item-title{font-weight:500;color:#555;margin-bottom:5px}
.num-container{display:flex;flex-wrap:wrap;gap:8px}
.num-unit{color:var(--primary);font-weight:700;background:#fff5f5;padding:2px 6px;border-radius:4px}

.accordion{margin-top:15px;border:1px solid #ddd;border-radius:12px;overflow:hidden}
.acc-header{background:var(--accent);color:#fff;padding:14px;font-weight:600;cursor:pointer;text-align:center}
.acc-body{display:none;background:#fafafa;padding:0 14px}
.ad-container { margin: 25px 0; text-align: center; min-height: 100px; }

/* üêò Î£∞Î†õ Ï†ÑÏö© Ïä§ÌÉÄÏùº */
.roulette-wrapper { position: relative; width: 300px; height: 300px; margin: 20px auto 30px; }
.elephant-bg {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 120px; height: 120px; opacity: 0.25; z-index: 1;
    background: url('https://img.icons8.com/ios-filled/200/666666/elephant.png') no-repeat center/contain;
}
#rouletteCanvas { position: relative; z-index: 2; border: 6px solid var(--thai-gold); border-radius: 50%; transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); background: transparent; }
.pointer {
    position: absolute; top: -15px; left: 50%; transform: translateX(-50%); z-index: 10;
    width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid var(--thai-red);
}
.r-input-item { display: flex; align-items: center; border-bottom: 1px solid #eee; padding: 10px 0; }
.r-input-item span { font-size: 13px; color: #aaa; width: 25px; }
.btn-spin { width: 100%; padding: 16px; background: var(--thai-red); color: white; border: none; border-radius: 30px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 20px; }
.reset-link { font-size: 12px; color: #999; text-decoration: underline; cursor: pointer; display: block; margin-top: 10px; text-align: right; }

/* ü™ú ÏÇ¨Îã§Î¶¨ ÌÉÄÍ∏∞ Ï†ÑÏö© Ïä§ÌÉÄÏùº */
.ladder-board { position: relative; margin: 25px 0; }
.header-nodes, .footer-nodes { display: flex; justify-content: space-around; }
.node-btn { width: 44px; height: 44px; border-radius: 14px; border: none; background: var(--thai-red); color: gold; font-weight: 700; cursor: pointer; transition: 0.3s; z-index: 60; position: relative; }
.result-input { width: 55px; border: none; border-bottom: 2px solid #F0F0F0; text-align: center; font-size: 14px; font-weight: 700; padding: 8px 0; background: transparent; color: #444; }
.canvas-container { position: relative; width: 100%; height: 420px; margin: 15px 0; }
#ladderCanvas { width: 100%; height: 100%; display: block; }
#elephantSprite { 
    position: absolute; font-size: 42px; z-index: 100; pointer-events: none; display: none;
    transform-origin: center bottom;
    transition: left 0.45s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s ease;
}
#blindLayer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.92); backdrop-filter: blur(12px); z-index: 50; display: flex; align-items: center; justify-content: center; border-radius: 20px; transition: 0.7s; font-weight: bold; color: var(--thai-gold); letter-spacing: 2px; font-size: 14px; }
#blindLayer.hidden { opacity: 0; pointer-events: none; transform: scale(1.05); }
.action-bar { display: flex; gap: 12px; margin-top: 30px; }
.btn-main { flex: 1; padding: 16px; border: none; border-radius: 18px; font-weight: 700; cursor: pointer; transition: 0.2s; font-size: 13px; }
.btn-gold { background: var(--thai-gold); color: white; }

/* ÎãπÏ≤® ÌåùÏóÖ Î†àÏù¥Ïñ¥ */
.overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999; }
#winnerPopup {
    display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
    background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 50px rgba(0,0,0,0.3);
    z-index: 2000; text-align: center; width: 80%; max-width: 300px; border: 5px solid var(--thai-gold);
    animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes popIn { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
#winnerPopup h1 { font-size: 2.2rem; margin: 15px 0; color: var(--thai-red); }
</style>
</head>

<body>

<header class="top-nav">
<div class="nav-inner">
<div class="logo" onclick="showPage('home')"><img src="logo.png"></div>
<nav class="menu">
<span onclick="showPage('home')">Home</span>
<div class="dropdown">
<span>‡∏•‡∏≠‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà ‚ñæ</span>
<div class="dropdown-menu">
<div onclick="showPage('lotto-now')"> ‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>
</div>
</div>
<span onclick="showPage('recommend')">‡πÄ‡∏•‡∏Ç‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</span>
<span onclick="showPage('fortune')">‡∏î‡∏ß‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
<span onclick="showPage('lucky')">‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ</span>
<span onclick="showPage('roulette')" style="color:var(--thai-red)">üêò ‡∏ß‡∏á‡∏•‡πâ‡∏≠</span>
<span onclick="showPage('ladder')" style="color:var(--thai-gold)">ü™ú ‡∏ö‡∏±‡∏ô‡πÑ‡∏î</span>
</nav>
</div>
</header>

<main>
<section id="home" class="page">
<div class="card" style="text-align:center">
<h2>‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î üáπüá≠</h2>
<p>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏™‡∏•‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡πÑ‡∏ó‡∏¢</p>
<button onclick="showPage('lotto-now')">‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
</div>
</section>

<section id="lotto-now" class="page">
<div class="card">
<h3>üéØ ‡∏ï‡∏£‡∏ß‡∏à‡∏ú‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
<div class="date" id="drawDate">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
<div class="input-box">
<input id="myNum" maxlength="6" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç 6 ‡∏´‡∏•‡∏±‡∏Å" type="tel">
<button onclick="checkWin()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
</div>
<div id="winResult" class="result"></div>
<div id="lottoList"></div>
</div>
</section>

<section id="recommend" class="page">
<div class="card" style="text-align:center">
<h3>üé≤ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ</h3>
<h1 id="recNum" style="letter-spacing:6px">------</h1>
<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:20px">
<button onclick="recommendN(1)">1‡∏ï‡∏±‡∏ß</button>
<button onclick="recommendN(2)">2‡∏ï‡∏±‡∏ß</button>
<button onclick="recommendN(3)">3‡∏ï‡∏±‡∏ß</button>
<button onclick="recommendN(4)">4‡∏ï‡∏±‡∏ß</button>
<button onclick="recommendN(5)">5‡∏ï‡∏±‡∏ß</button>
<button onclick="recommendN(6)">6‡∏ï‡∏±‡∏ß</button>
</div>
</section>

<section id="fortune" class="page">
<div class="card" style="text-align:center">
<h3>üîÆ ‡∏î‡∏ß‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>
<div id="fortuneText" style="font-size:18px;margin:20px"></div>
<button onclick="refreshFortune()">‡∏î‡∏π‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
</div>
</section>

<section id="lucky" class="page">
<div class="card" style="text-align:center">
<h3>üçÄ ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ</h3>
<div class="input-box"><input type="date" id="luckyBirth"></div>
<div class="input-box"><input type="text" id="luckyName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô"></div>
<button onclick="makeLuckyNumber()">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ</button>
<div id="luckyResult" class="result"></div>
</div>
</section>

<section id="roulette" class="page">
<div class="card" style="text-align:center">
<h3>üêò ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏ä‡πâ‡∏≤‡∏á‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ</h3>
<p style="font-size:13px; color:#888;">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏≤‡∏¢</p>
<div class="roulette-wrapper">
    <div class="pointer"></div>
    <div class="elephant-bg"></div>
    <canvas id="rouletteCanvas" width="300" height="300"></canvas>
</div>
<div id="rouletteInputs" style="text-align:left; max-width:300px; margin:auto;">
    <div class="r-input-item"><span>1</span><input type="text" class="item-input" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1" oninput="handleRInput(this)"></div>
    <div class="r-input-item"><span>2</span><input type="text" class="item-input" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 2" oninput="handleRInput(this)"></div>
</div>
<span class="reset-link" onclick="resetR()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Ï¥àÍ∏∞Ìôî)</span>
<button class="btn-spin" onclick="spinR()">‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠!</button>
</div>
</section>

<section id="ladder" class="page">
    <div class="card" style="text-align:center">
        <h3 style="color:var(--thai-red);">üêò ‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏ä‡πâ‡∏≤‡∏á (ÏÇ¨Îã§Î¶¨)</h3>
        <div style="color:var(--thai-gold); font-size:11px; font-weight:700; letter-spacing: 2px; margin-bottom: 15px;">PATH TRACKING MODE</div>

        <div class="ladder-board">
            <div id="headerBox" class="header-nodes"></div>
            <div class="canvas-container">
                <div id="blindLayer">üîí CLICK TO START</div>
                <div id="elephantSprite">üêò</div>
                <canvas id="ladderCanvas"></canvas>
            </div>
            <div id="footerBox" class="footer-nodes"></div>
        </div>

        <div class="action-bar">
            <button class="btn-main btn-gold" onclick="adjustSize(1)">PLAYER (+)</button>
            <button class="btn-main btn-gold" onclick="adjustSize(-1)">REMOVE (-)</button>
            <button class="btn-main" onclick="initLadder()" style="background:#f5f5f5;">RESET</button>
        </div>
    </div>
</section>

<div class="ad-container">
    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6972769827165057" data-ad-slot="4871459069" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div>
</main>

<div class="overlay" id="overlay" onclick="closePopup()"></div>
<div id="winnerPopup">
    <p>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! (Ï∂ïÌïòÌï©ÎãàÎã§)</p>
    <h1 id="winnerName"></h1>
    <button onclick="closePopup()" style="background:var(--thai-red); width:100%; padding:12px;">OK</button>
</div>

<script>
// --- Í≥µÌÜµ ÌéòÏù¥ÏßÄ Ï†ÑÌôò ---
function showPage(id){
document.querySelectorAll('.page').forEach(p=>p.style.display='none');
const t=document.getElementById(id);
if(t)t.style.display='block';
if(id==='fortune')refreshFortune();
if(id==='roulette')drawR();
if(id==='ladder') initLadder();
}
showPage('home');

// --- Î°úÎòê/Ïö¥ÏÑ∏ Î°úÏßÅ ---
const PRIZE_MONEY={"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1":6000000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 1":100000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 2":200000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3":80000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 4":40000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 5":20000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ 3 ‡∏ï‡∏±‡∏ß":4000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢ 3 ‡∏ï‡∏±‡∏ß":4000,"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÄ‡∏•‡∏Ç‡∏ó‡πâ‡∏≤‡∏¢ 2 ‡∏ï‡∏±‡∏ß":2000};
let lottoData=null;
fetch("https://lotto.api.rayriffy.com/latest").then(r=>r.json()).then(j=>{lottoData=j.response;renderLotto(lottoData);});

function renderLotto(data){
document.getElementById("drawDate").innerText=`‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ö‡∏™‡∏•‡∏≤‡∏Å : ${data.date}`;
const box=document.getElementById("lottoList");box.innerHTML="";
const acc=document.createElement("div");acc.className="accordion";
const h=document.createElement("div");h.className="acc-header";h.innerText="üìÇ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3-5";
const b=document.createElement("div");b.className="acc-body";
h.onclick=()=>{b.style.display=b.style.display==="none"?"block":"none";h.innerText=b.style.display==="block"?"üìÇ ‡∏õ‡∏¥‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3-5":"üìÇ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà 3-5"};
const mk=(n,nums)=>{const d=document.createElement("div");d.className="item";d.innerHTML=`<div class="item-title">${n}</div><div class="num-container">${[...nums].sort().map(x=>`<span class="num-unit">${x}</span>`).join("")}</div>`;return d};
data.prizes.forEach(p=>{(p.name.match(/[345]/)?b:box).appendChild(mk(p.name,p.number))});
acc.append(h,b);box.appendChild(acc);
data.runningNumbers.forEach(r=>box.appendChild(mk(r.name,r.number)));
}

function checkWin(){
const n=document.getElementById("myNum").value; const box=document.getElementById("winResult");
if(n.length!==6)return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 6 ‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á.");
let w=[],t=0;
lottoData.prizes.forEach(p=>{if(p.number.includes(n)){w.push(p.name);t+=PRIZE_MONEY[p.name]||0}});
lottoData.runningNumbers.forEach(r=>{
if(r.name.includes("‡∏´‡∏ô‡πâ‡∏≤")&&r.number.includes(n.slice(0,3)))t+=4000,w.push(r.name);
if(r.name.includes("‡∏ó‡πâ‡∏≤‡∏¢ 3")&&r.number.includes(n.slice(-3)))t+=4000,w.push(r.name);
if(r.name.includes("‡∏ó‡πâ‡∏≤‡∏¢ 2")&&r.number.includes(n.slice(-2)))t+=2000,w.push(r.name);
});
box.style.display="block";box.style.background=w.length?"var(--success)":"var(--fail)";
box.innerHTML=w.length?`üéâ ‡∏ñ‡∏π‡∏Å‡πÅ‡∏•‡πâ‡∏ß!<br>${w.join("<br>")}<hr><b>${t.toLocaleString()} ‡∏ø</b>`:"üò¢ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ";
}

function recommendN(len){document.getElementById("recNum").innerText=Math.floor(Math.random()*10**len).toString().padStart(len,'0');}
const fortunes=["Ïò§ÎäòÏùÄ ÌñâÏö¥Ïùò ÎÇ† üçÄ","ÎúªÎ∞ñÏùò Í∏∞Ìöå ‚ú®","ÏßÄÏ∂ú Ï£ºÏùò üí∞","Î°úÎòê ÏÇ¨Í∏∞ Ï¢ãÏùÄ ÎÇ† üéüÔ∏è","Ï∞®Î∂ÑÌï®Ïù¥ ÌñâÏö¥ üßò"];
function refreshFortune(){document.getElementById("fortuneText").innerText=fortunes[Math.floor(Math.random()*fortunes.length)];}
function makeLuckyNumber(){
const b=document.getElementById("luckyBirth").value; const n=document.getElementById("luckyName").value;
if(!b)return alert("‡∏õ‡πâ‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î");
const bn=b.replaceAll("-","").split("").reduce((a,c)=>a+Number(c),0)%9+1;
const d=new Date();const dn=(d.getDate()+d.getMonth()+1)%9+1; const nn=n?n.length%10:0;
const r=document.getElementById("luckyResult");r.style.display="block";r.style.background="var(--success)";
r.innerHTML=`<h1 style="letter-spacing:6px">${bn}${dn}${(bn+dn+nn)%10}</h1>`;
}

// --- üêò Î£∞Î†õ Î°úÏßÅ ---
const canvasR = document.getElementById('rouletteCanvas');
const ctxR = canvasR.getContext('2d');
const rInputs = document.getElementById('rouletteInputs');
const rColors = ["rgba(255,255,255,0.75)", "rgba(242,240,235,0.75)", "rgba(220,220,220,0.75)", "rgba(235,230,220,0.75)"];
let isSpinning = false;
let currRot = 0;

function handleRInput(el) {
    const inputs = document.querySelectorAll('.item-input');
    const last = inputs[inputs.length-1];
    if(last.value.trim() !== "" && inputs.length < 10) {
        const div = document.createElement('div'); div.className = 'r-input-item';
        div.innerHTML = `<span>${inputs.length+1}</span><input type="text" class="item-input" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ${inputs.length+1}" oninput="handleRInput(this)">`;
        rInputs.appendChild(div);
    }
    drawR();
}

function drawR() {
    const items = Array.from(document.querySelectorAll('.item-input')).map(i=>i.value.trim()).filter(v=>v!=="");
    ctxR.clearRect(0,0,300,300);
    if(items.length < 2) {
        ctxR.beginPath(); ctxR.fillStyle="rgba(255,255,255,0.5)"; ctxR.arc(150,150,150,0,2*Math.PI); ctxR.fill();
        return;
    }
    const arc = (2*Math.PI)/items.length;
    items.forEach((text, i) => {
        const angle = i*arc;
        ctxR.beginPath(); ctxR.fillStyle=rColors[i%rColors.length]; ctxR.moveTo(150,150); ctxR.arc(150,150,150,angle,angle+arc); ctxR.fill();
        ctxR.strokeStyle="rgba(0,0,0,0.05)"; ctxR.stroke();
        ctxR.save(); ctxR.translate(150,150); ctxR.rotate(angle+arc/2); ctxR.textAlign="right"; ctxR.fillStyle="#333"; ctxR.font="bold 15px Tahoma"; ctxR.fillText(text, 140, 5); ctxR.restore();
    });
}

function spinR() {
    const items = Array.from(document.querySelectorAll('.item-input')).map(i=>i.value.trim()).filter(v=>v!=="");
    if(items.length < 2) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£!");
    if(isSpinning) return;
    isSpinning = true;
    const rot = Math.floor(Math.random()*360) + 3600; currRot += rot;
    canvasR.style.transform = `rotate(${currRot}deg)`;
    setTimeout(() => {
        isSpinning = false;
        const actual = currRot % 360;
        const arcDeg = 360 / items.length;
        const idx = Math.floor(((360 - (actual % 360) + 270) % 360) / arcDeg);
        document.getElementById('winnerName').innerText = items[idx % items.length] + "!";
        document.getElementById('winnerPopup').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }, 4000);
}

function closePopup() {
    document.getElementById('winnerPopup').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
}

function resetR() {
    if(!confirm("ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")) return;
    rInputs.innerHTML = `
        <div class="r-input-item"><span>1</span><input type="text" class="item-input" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1" oninput="handleRInput(this)"></div>
        <div class="r-input-item"><span>2</span><input type="text" class="item-input" placeholder="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 2" oninput="handleRInput(this)"></div>
    `;
    drawR();
}

// --- ü™ú ÏÇ¨Îã§Î¶¨ ÌÉÄÍ∏∞ Î°úÏßÅ ---
let ladderCount = 4;
let legs = [];
let ladderMoving = false;
let historyPath = [];
const ladderCanvas = document.getElementById('ladderCanvas');
const ctxL = ladderCanvas.getContext('2d');
const sprite = document.getElementById('elephantSprite');
const blind = document.getElementById('blindLayer');

function initLadder() {
    ladderMoving = false;
    historyPath = [];
    sprite.style.display = 'none';
    blind.classList.remove('hidden');
    const container = document.querySelector('.canvas-container');
    ladderCanvas.width = container.clientWidth;
    ladderCanvas.height = container.clientHeight;
    
    const hBox = document.getElementById('headerBox');
    const fBox = document.getElementById('footerBox');
    hBox.innerHTML = ''; fBox.innerHTML = '';
    
    for(let i=0; i<ladderCount; i++) {
        const btn = document.createElement('button');
        btn.className = 'node-btn';
        btn.innerText = String.fromCharCode(65 + i);
        btn.onclick = () => runLadder(i);
        hBox.appendChild(btn);
        
        const input = document.createElement('input');
        input.className = 'result-input';
        input.value = (i === 0) ? "WIN" : "X";
        fBox.appendChild(input);
    }
    generateLegs();
    renderLadder();
}

function adjustSize(n) { if(ladderCount + n >= 2 && ladderCount + n <= 10) { ladderCount += n; initLadder(); } }

function generateLegs() {
    legs = [];
    const rows = 6;
    for(let i=0; i<ladderCount-1; i++) {
        let legInColumn = 0;
        for(let j=0; j<rows; j++) {
            if(Math.random() > 0.75 && legInColumn < 3) { 
                legs.push({ col: i, y: Math.floor((j+1) * (ladderCanvas.height / (rows + 1))), used: false });
                legInColumn++;
            }
        }
        if(legInColumn === 0) {
            const randomRow = Math.floor(Math.random() * rows);
            legs.push({ col: i, y: Math.floor((randomRow+1) * (ladderCanvas.height / (rows + 1))), used: false });
        }
    }
    legs.sort((a, b) => a.y - b.y);
}

function renderLadder() {
    ctxL.clearRect(0, 0, ladderCanvas.width, ladderCanvas.height);
    const gap = ladderCanvas.width / (ladderCount + 1);
    
    ctxL.strokeStyle = "#F2F2F2";
    ctxL.lineWidth = 5;
    for(let i=1; i<=ladderCount; i++) {
        ctxL.beginPath(); ctxL.moveTo(i*gap, 0); ctxL.lineTo(i*gap, ladderCanvas.height); ctxL.stroke();
    }
    ctxL.strokeStyle = "#C5A059";
    ctxL.lineWidth = 4;
    legs.forEach(l => {
        ctxL.beginPath(); ctxL.moveTo((l.col+1)*gap, l.y); ctxL.lineTo((l.col+2)*gap, l.y); ctxL.stroke();
    });

    if(historyPath.length > 1) {
        ctxL.strokeStyle = "#8B2323";
        ctxL.lineWidth = 6;
        ctxL.lineCap = "round";
        ctxL.lineJoin = "round";
        ctxL.beginPath();
        ctxL.moveTo(historyPath[0].x, historyPath[0].y);
        for(let i=1; i<historyPath.length; i++) {
            ctxL.lineTo(historyPath[i].x, historyPath[i].y);
        }
        ctxL.stroke();
    }
}

async function runLadder(startIdx) {
    if(ladderMoving) return;
    ladderMoving = true;
    historyPath = [];
    blind.classList.add('hidden');
    legs.forEach(l => l.used = false);
    
    const gap = ladderCanvas.width / (ladderCount + 1);
    let curX = (startIdx + 1) * gap;
    let curY = 0;
    let curCol = startIdx;

    historyPath.push({x: curX, y: curY});
    sprite.style.display = 'block';
    sprite.style.left = curX + 'px';
    sprite.style.top = '0px';

    const step = 3; 

    const animate = () => {
        return new Promise((res) => {
            const frame = async () => {
                curY += step;
                historyPath.push({x: curX, y: curY});

                for(let l of legs) {
                    if(!l.used && Math.abs(l.y - curY) <= step) {
                        if(l.col === curCol || l.col === curCol - 1) {
                            l.used = true;
                            curY = l.y;
                            historyPath.push({x: curX, y: curY});

                            if(l.col === curCol) {
                                curCol++;
                                sprite.style.transform = "translate(-50%, -80%) scaleX(-1) rotate(10deg)";
                            } else {
                                curCol--;
                                sprite.style.transform = "translate(-50%, -80%) scaleX(1) rotate(-10deg)";
                            }
                            
                            curX = (curCol + 1) * gap;
                            historyPath.push({x: curX, y: curY});
                            sprite.style.left = curX + 'px';
                            sprite.style.top = curY + 'px';
                            
                            await new Promise(r => setTimeout(r, 450));
                            sprite.style.transform = "translate(-50%, -80%) rotate(0deg)";
                        }
                    }
                }
                sprite.style.top = curY + 'px';
                sprite.style.left = curX + 'px';
                renderLadder();

                if(curY < ladderCanvas.height) {
                    requestAnimationFrame(frame);
                } else {
                    res(curCol);
                }
            };
            requestAnimationFrame(frame);
        });
    };

    const resultCol = await animate();
    const results = document.querySelectorAll('.result-input');
    
    // Í≤∞Í≥º ÌåùÏóÖ Ï†ÅÏö© (Î£∞Î†õÍ≥º ÎèôÏùº)
    setTimeout(() => {
        document.getElementById('winnerName').innerText = results[resultCol].value + "!";
        document.getElementById('winnerPopup').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
        ladderMoving = false;
    }, 500);
}
</script>

</body>
</html>
